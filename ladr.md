# Архитектурное решение: Выбор системы мониторинга

## Контекст

В процессе разработки нашего приложения встала необходимость настроить мониторинг для серверов и сервисов. На конференции был рекомендован Prometheus как лучшее решение для сбора метрик на данный момент. Приложения, которые мы разрабатываем, будут отправлять метрики в формате Prometheus.

В то же время, важно учитывать, что мы не хотим ограничивать себя одной системой, поэтому архитектурное решение должно быть гибким и легко модифицируемым в будущем.

## Решение

Мы выбираем Prometheus как основную систему мониторинга для сбора и хранения метрик.

### Причины выбора:
- **Широкая поддержка**: Prometheus поддерживается множеством систем и сервисов, что упрощает интеграцию.
- **Активная разработка и сообщество**: Prometheus — популярный проект с активным развитием и поддержкой, что гарантирует своевременные обновления и исправления.
- **Поддержка формата метрик Prometheus**: Наши приложения будут отправлять метрики в формате Prometheus, что упрощает настройку и поддержку системы.
- **Широкие возможности масштабирования**: Prometheus может эффективно масштабироваться и поддерживает горизонтальное масштабирование с помощью Thanos.
- **Гибкость и модульность**: Prometheus может быть легко интегрирован с другими инструментами (например, с Grafana для визуализации данных).

## Альтернативы

### 1. **Zabbix**
- **Преимущества**: Zabbix хорошо подходит для более традиционного мониторинга серверов и сетевой инфраструктуры. Имеет встроенную визуализацию и алертинг.
- **Недостатки**: Требует больше ресурсов для развертывания и сложнее в настройке. Не так удобен для работы с метриками приложений и контейнерных сред.

### 2. **Nagios**
- **Преимущества**: Nagios — это надежная и проверенная система мониторинга для серверов и сетевых устройств.
- **Недостатки**: Менее гибкая в плане работы с метриками приложений, недостаточно современная для работы с контейнерами и динамическими окружениями.

### 3. **InfluxDB + Telegraf + Grafana**
- **Преимущества**: InfluxDB — это хорошее решение для работы с временными рядами данных, а Telegraf может собирать метрики из множества источников.
- **Недостатки**: Требует больше настройки и ресурсов, чем Prometheus. Prometheus лучше интегрируется с нашим текущим стеком.

## Последствия

### Положительные:
- Упрощенная настройка мониторинга для текущих приложений, использующих формат метрик Prometheus.
- Возможность расширения и интеграции с другими системами визуализации, такими как Grafana.
- Более быстрая настройка и меньшие затраты на поддержание системы мониторинга.

### Отрицательные:
- Зависимость от Prometheus, что может потребовать дополнительных усилий при переходе на другую систему в будущем.
- Необходимость дополнительных ресурсов для хранения метрик при масштабировании.

## Принятое решение

Мы решили использовать Prometheus в качестве основной системы мониторинга. Для визуализации метрик будет использована Grafana.

## Дата принятия решения

06 октября 2024 года

## Автор

Ivan Filatoff
